# ========================================
# Playwright Test Configuration
# ========================================
# Copy this file to .env and update with your values
# ========================================

# ===== Base Configuration =====

# Base URL for Hyperswitch API (using 127.0.0.1 instead of localhost to force IPv4)
PLAYWRIGHT_BASEURL=http://127.0.0.1:8080


# Admin API Key for merchant setup
PLAYWRIGHT_ADMINAPIKEY=test_admin

# Connector authentication credentials file (absolute path)
PLAYWRIGHT_CONNECTOR_AUTH_FILE_PATH=/path/to/creds.json

# Default connector to use (stripe, cybersource, adyen, etc.)
# This is used when running tests for a single connector
PLAYWRIGHT_CONNECTOR=stripe

# Multiple connectors for parallel execution (comma-separated)
# Both connectors will run in parallel
PLAYWRIGHT_CONNECTORS=stripe,cybersource

# ===== Browser Configuration =====

# Run tests in headless mode
# true = no visible browser (faster, recommended for CI)
# false = visible browser (useful for debugging)
HEADLESS=true

# ===== Browser Pool Configuration =====
# Multi-Tab Parallel Execution Strategy
# ========================================

# Enable browser pool for maximum parallelism with minimal RAM
# true = Use browser pool (25-50 concurrent tests, ~14-15 GB RAM)
# false = Use traditional approach (each test gets own browser, higher RAM)
#
# Browser Pool Strategy:
# - 2 browsers (1 per connector: Stripe + Cybersource)
# - N reusable contexts per browser (configurable below)
# - Total concurrent tests = CONTEXTS_PER_BROWSER per connector
#
# Benefits:
# - 20x faster than sequential execution
# - ~85% RAM savings vs traditional approach
# - Optimal for CI environments with 16 GB RAM limit
USE_BROWSER_POOL=true

# Number of browser contexts per browser (reusable tabs)
# Recommended values:
# - Local (8-16 GB):  10-15 contexts  (~6-8 GB RAM)
# - Local (16+ GB):   15-20 contexts  (~8-12 GB RAM)
# - CI (16 GB):       25 contexts     (~14-15 GB RAM, optimal)
# - CI (32 GB):       40-50 contexts  (~20-25 GB RAM)
#
# RAM Formula:
# Total RAM = (Browsers × 600 MB) + (Total Contexts × 50 MB)
#
# Examples:
# - 2 browsers × 25 contexts = 1.2 GB + 2.5 GB = ~3.7 GB base + overhead = ~14-15 GB
# - 2 browsers × 10 contexts = 1.2 GB + 1.0 GB = ~2.2 GB base + overhead = ~6-8 GB
CONTEXTS_PER_BROWSER=25

# Enable verbose logging for browser pool operations
# Shows context allocation, release, and queue events
# Useful for debugging pool behavior
VERBOSE_POOL=false

# ===== Performance & Debugging =====

# CI environment flag (automatically set by CI systems)
# Affects retries, video recording, and cleanup behavior
CI=false

# ===== Test Execution =====

# Test timeout (milliseconds)
# Individual test timeout - will fail test if exceeded
# Default: 120000 (2 minutes)
# Increase for slow tests
# TEST_TIMEOUT=120000

# ===== Expected Performance Metrics =====
# (For reference - actual values depend on system and test count)
#
# Browser Pool Mode (USE_BROWSER_POOL=true):
# - Setup Phase: ~20 seconds (8 tests, sequential)
# - Parallel Phase: ~60-90 seconds (remaining tests, 50 concurrent)
# - Total: ~1.5-2 minutes for full suite
# - RAM: ~14-15 GB peak (with CONTEXTS_PER_BROWSER=25)
#
# Traditional Mode (USE_BROWSER_POOL=false):
# - Sequential execution: ~20-30 minutes
# - RAM: ~2-4 GB (lower but slower)
#
# Speedup: ~15-20x with browser pool enabled

# ===== Connector-Specific Notes =====
#
# Stripe:
# - Fastest test execution
# - Most test coverage
# - Test files: tests/e2e/setup/* and tests/e2e/spec/*
#
# Cybersource:
# - Slightly slower than Stripe
# - Same test structure as Stripe
# - Runs in parallel with Stripe when both enabled
#
# To test only one connector:
# 1. Set PLAYWRIGHT_CONNECTOR=stripe (or cybersource)
# 2. Run: npx playwright test --project=stripe-*
